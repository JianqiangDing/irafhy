<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="cache-control" content="max-age=86400"/>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.13"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>irafhy: Tutorial</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
            <tbody>
            <tr style="height: 56px;">
                <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
                <td id="projectalign" style="padding-left: 0.5em;">
                    <div id="projectname">irafhy
                    </div>
                    <div id="projectbrief">Interval arithmetic based Reachability Analysis Framework for Hybrid Automaton</div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tutorial.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this section, we will introduce you how to use this library to define your own algorithm and how to write the test cases, at the end of this section, some options about the results plotting were provided.</p>
<h2>customize your own algorithm</h2>
<p>For convenience, the concept of hybrid systems is referred to in the <b>Thomas A Henzinger</b>'s paper. Almost all decouplable modules in the accessibility process are decoupled into separate computing modules. However, at present, we only allow users to build specific accessibility analysis algorithms by customizing three modules as follows:</p>
<h3>Analyser</h3>
<p>The analyzer module is mainly used to solve the initial value problem, that is to say, given the specified initial state set and the specified duration, as well as the given continuous dynamic system, the module should return the state set that the continuous dynamic system can reach. Different reach-ability analysis algorithms usually define their own specific calculation methods to get the reachable set in a certain time interval. Therefore, we public the module, so that users can customize their own reach-ability set algorithm by customizing the actual calculation method within the Analyzer module.</p>
<p>e.g. if you just want to get the over approximate state set in a duration, you can simply call the solver which can return the over approximate set as following:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="analyser_8h.html">irafhy/analyser.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="intervalHull_8h.html">irafhy/representation/geometric/intervalHull.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../settings/settings.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    <span class="keyword">class </span>OAFAnalyser : <span class="keyword">public</span> <a class="code" href="classirafhy_1_1Analyser.html">irafhy::Analyser</a></div><div class="line">    {</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        capd::C0Rect2Set compute(<span class="keyword">const</span> <a class="code" href="structirafhy_1_1Time.html">irafhy::Time</a>&amp;     duration,</div><div class="line">                                 <span class="keyword">const</span> <a class="code" href="classirafhy_1_1System.html">irafhy::System</a>&amp;   system,</div><div class="line">                                 <span class="keyword">const</span> capd::C0Rect2Set&amp; initCondition,</div><div class="line">                                 <span class="keyword">const</span> Settings&amp;         settings) <span class="keyword">const override</span>;</div><div class="line">    };</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --><div style="text-align: center;"> source code of ./algorithm/overApproximateForward/analyser/analyser.h </div><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="analyser_8h.html">analyser.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ODESolver_8h.html">irafhy/utility/solver/ODESolver.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    capd::C0Rect2Set OAFAnalyser::compute(<span class="keyword">const</span> <a class="code" href="structirafhy_1_1Time.html">irafhy::Time</a>&amp;    duration,</div><div class="line">                                          <span class="keyword">const</span> <a class="code" href="classirafhy_1_1System.html">irafhy::System</a>&amp;   system,</div><div class="line">                                          <span class="keyword">const</span> capd::C0Rect2Set&amp; initCondition,</div><div class="line">                                          <span class="keyword">const</span> <a class="code" href="classirafhy_1_1Settings.html">irafhy::Settings</a>&amp; settings)<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">try</span></div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> <a class="code" href="classirafhy_1_1ODESolver.html#a1b6f27a63d71819d29104ca656739d35">ODESolver::solve</a>(system, initCondition, duration);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_cast&amp; e)</div><div class="line">        {</div><div class="line">            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;</div><div class="line">            exit(EXIT_FAILURE);</div><div class="line">        }</div><div class="line">    }</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --> <div style="text-align: center;"> source code of ./algorithm/overApproximateForward/analyser/analyser.cpp </div><p>As you can see, there is nothing special within the analyser but an ODE solver calling. all you need to do is to define your own class which inherited from the pre-defined <b>Analyser</b> and overwrite the pure virtual method compute. you can also define a relatively complex analyser class like this which implement the algorithm in <b>Bai Xue</b>'s paper</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="analyser_8h.html">irafhy/analyser.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="intervalHull_8h.html">irafhy/representation/geometric/intervalHull.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="polytope_8h.html">irafhy/representation/geometric/polytope.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../settings/settings.h&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;omp.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    <span class="keyword">class </span>UABPAnalyser : <span class="keyword">public</span> Analyser</div><div class="line">    {</div><div class="line">    <span class="keyword">private</span>:</div><div class="line">        [[nodiscard]] std::vector&lt;IntervalHull&gt; boundary(<span class="keyword">const</span> Condition&amp; condition, <span class="keywordtype">double</span> epsilon) <span class="keyword">const</span>;</div><div class="line">        [[nodiscard]] std::vector&lt;IntervalHull&gt; simulate(<span class="keyword">const</span> Time&amp;                      duration,</div><div class="line">                                                         <span class="keyword">const</span> System&amp;                    system,</div><div class="line">                                                         <span class="keyword">const</span> std::vector&lt;IntervalHull&gt;&amp; boundaryIntervalHulls) <span class="keyword">const</span>;</div><div class="line">        [[nodiscard]] Polytope                  constructPolytope(<span class="keyword">const</span> std::vector&lt;IntervalHull&gt;&amp; boundary) <span class="keyword">const</span>;</div><div class="line">        [[nodiscard]] Polytope                  contraction(<span class="keyword">const</span> Polytope&amp;                  polytope,</div><div class="line">                                                            <span class="keyword">const</span> std::vector&lt;IntervalHull&gt;&amp; boundary,</div><div class="line">                                                            <span class="keywordtype">bool</span>                             isExact) <span class="keyword">const</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        [[nodiscard]] capd::C0Rect2Set compute(<span class="keyword">const</span> Time&amp;             duration,</div><div class="line">                                               <span class="keyword">const</span> System&amp;           system,</div><div class="line">                                               <span class="keyword">const</span> capd::C0Rect2Set&amp; initCondition,</div><div class="line">                                               <span class="keyword">const</span> Settings&amp;         settings) <span class="keyword">const override</span>;</div><div class="line">    };</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --><div style="text-align: center;"> source code of ./algorithm/underApproximateBackwardUsingPolytope/analyser/analyser.h </div><h3>Verifier</h3>
<p>The verifier module is another module you need to customize before testing your own algorithm. this module responsible for the verification of the running procedure. it is used to control whether the procedure should be terminated. the verification method will be called after each step. return <b>TRUE</b> means the algorithm can be run one more step. <b>FALSE</b> means the algorithm should not be running any more. you can customize your own verifier just like what we do in the previous subsection.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="verifier_8h.html">irafhy/verifier.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="hybridautomaton_8h.html">irafhy/representation/formal/hybridAutomaton/hybridautomaton.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    <span class="keyword">class </span>OAFVerifier : <span class="keyword">public</span> Verifier</div><div class="line">    {</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        <span class="keywordtype">bool</span> verify(<span class="keyword">const</span> Settings&amp; settings, <span class="keyword">const</span> <span class="keywordtype">void</span>* hybridAutomaton) <span class="keyword">const</span>;</div><div class="line">    };</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --><div style="text-align: center;"> source code of ./algorithm/overApproximateForward/verifier/verifier.h </div><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="verifier_8h.html">verifier.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    <span class="keywordtype">bool</span> OAFVerifier::verify(<span class="keyword">const</span> Settings&amp; settings, <span class="keyword">const</span> <span class="keywordtype">void</span>* hybridAutomaton)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --><div style="text-align: center;"> source code of ./algorithm/overApproximateForward/verifier/verifier.cpp </div><p>for more complex verifier example, you can check the source code of the repository.</p>
<h3>Settings</h3>
<p>It is inevitable to set some parameters related to the algorithm. For this part, we use <b>Settings</b> class to maintain all of them. you can customize your own <b>Settings</b> class to maintain the parameters you need and add some other methods you want. e.g.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="settings_8h.html">irafhy/settings.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceirafhy.html">irafhy</a></div><div class="line">{</div><div class="line">    <span class="keyword">class </span>OAFSettings : <span class="keyword">public</span> Settings</div><div class="line">    {</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        OAFSettings(<span class="keyword">const</span> Settings&amp; settings);</div><div class="line"></div><div class="line">        <span class="keywordtype">void</span> help() <span class="keyword">const override</span>;</div><div class="line">    };</div><div class="line">} <span class="comment">// namespace irafhy</span></div></div><!-- fragment --><div style="text-align: center;"> source code of ./algorithm/overApproximateForward/settings/settings.h </div><p>:warning: It should be noted that the <b>Analyser</b>, <b>Verifier</b>, <b>Settings</b> should be in the namespace <b>irafhy</b>.</p>
<h2>configure the test case</h2>
<p>All the configurations related to the test case should be defined in two files, one for <b>Hybrid System</b>, the other for <b>Settings</b>. e.g.</p>
<div class="fragment"><div class="line">HYBRID_AUTOMATON</div><div class="line">{</div><div class="line">    NAME Fitz Hugh Nagumo neuron model</div><div class="line"></div><div class="line">    VARIABLES</div><div class="line">    {</div><div class="line">        x y</div><div class="line">    }</div><div class="line"></div><div class="line">    LOCATIONS</div><div class="line">    {</div><div class="line">        MODEL</div><div class="line">        {</div><div class="line">            NAME electron</div><div class="line">            FLOWS</div><div class="line">            {</div><div class="line">                x&#39;=x-x^3-y+(7/8)</div><div class="line">                y&#39;=0.08*(x+0.7-0.8*y)</div><div class="line">            }</div><div class="line">            INVARIANT_CONDITIONS</div><div class="line">            {</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    TRANSITIONS</div><div class="line">    {</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><div style="text-align: center;"> source code of model.mdl </div><div class="fragment"><div class="line">SETTINGS</div><div class="line">{</div><div class="line">    TIME_HORIZON := [0,0.2]</div><div class="line">    STEP := 0.02</div><div class="line">    GEOMETRY := INTERVAL_HULL</div><div class="line">    PLOT := ON</div><div class="line">    PRINT := OFF</div><div class="line">    ANALYSIS := FORWARD</div><div class="line">    START_MODEL_ID := electron #name of the model</div><div class="line">    INITIAL_CONDITION :=</div><div class="line">    CONDITION</div><div class="line">    {</div><div class="line">        INTERVAL_HULL</div><div class="line">        {</div><div class="line">            [0.5,1.5],</div><div class="line">            [2.0,3.0]</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><div style="text-align: center;"> source code of setting.cfg </div><p>once two files done, the parameter inside shall be parsed by the parser only if you use the right name of the parameter and the set it to the right value.</p>
<h2>view the results</h2>
<p>The results can be plotted once the results generated, you can simply call the <b>show</b> method of class <b>viewer</b> to view them. the viewer current is generally an unpolished tool which supports limited viewing options, it will be improved future.</p>
<div class="fragment"><div class="line"><a class="code" href="classirafhy_1_1viewer.html#a4ae19d45ac1bc1e9e00a3dbe4d626ee5">irafhy::viewer::show</a>(</div><div class="line">                    this-&gt;intervalHulls_, </div><div class="line">                    this-&gt;points_, </div><div class="line">                    this-&gt;time_, {0, 1, 2}, </div><div class="line">                    <a class="code" href="namespaceirafhy.html#a0cfce1cc2fccb7692241cae7233bcac5aca720bb5beef6d8b0ae1426aedb8ac72">irafhy::VIEW_TYPE::LINE</a>);</div></div><!-- fragment --><p>as you can see, you should provide the geometry objects, points, the time intervals, the dimensions and the style of the plotting. here is a piece of screenshot showing a bunch of 3D interval hulls, some points and time intervals which indicate when these geometry objects generated. even the <em>dimension</em> values set to _{0,1,2}_, the viewer still just show 2D interval hulls cause the time intervals provided.</p>
<p><br />
 </p>
<div class="image">
<img src="viewerDemo.png" alt="viewerDemo" width="1000" height="1000"/>
</div>
 <h2>References</h2>
<ul>
<li>Thomas A Henzinger. The theory of hybrid automata. In Verification of digital and hybrid systems, pages 265–292. Springer, 2000</li>
<li>Bai Xue, Zhikun She, and Arvind Easwaran. Under-approximating backward reachable sets by polytopes. In International Conference on Computer Aided Verification, pages 457–476. Springer, 2016</li>
<li>Alec Jacobson, Daniele Panozzo, et al. libigl: A simple C++ geometry processing library, 2018. <a href="https://libigl.github.io/">https://libigl.github.io/</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
